@(item: services.item.Item)(implicit request: RequestHeader, webjars: WebJarAssets)
<html xmlns:xlink="http://www.w3.org/1999/xlink">
  <head>
    <title>@item.title | Peripleo</title>
    <link rel="stylesheet" href="@routes.WebJarAssets.at(webjars.locate("leaflet.css"))"/>
    <link rel="stylesheet" href="@routes.Assets.versioned("stylesheets/embed/index.css")"/>
    <script src="@routes.WebJarAssets.at(webjars.locate("1.12.0/jquery.min.js"))"></script>
    <script src="@routes.WebJarAssets.at(webjars.locate("leaflet.js"))"></script>
    <script src="@routes.WebJarAssets.at(webjars.locate("leaflet-iiif.js"))"></script>
    <script src="@routes.Assets.versioned("vendor/Leaflet.fullscreen.min.js")"></script>
    <script src="@routes.WebJarAssets.at(webjars.locate("numeral.min.js"))"></script>
    <script src="@routes.WebJarAssets.at(webjars.locate("require.min.js"))" data-main="@routes.Assets.versioned("javascripts/embed/embed.js")"></script>
  </head>
  <body>
    <div id="embed">
      <!-- div class="depiction"><span class="attribution"></span></div -->
      <div class="dogear @item.itemType"></div>
      <div class="card">
        <div class="item-info">
          @inDataset(item)
          @title(item)
          <p class="item-temporal-bounds"></p>
          @description(item)
        </div>
      </div>
    </div>
  </body>
</html>

@inDataset(item: services.item.Item) = {
  @defining(item.isConflationOf.flatMap(_.isInDataset)) { paths =>
    @if(!paths.isEmpty) {
      <p class="item-is-in">@for((id, title) <- paths.head.path) {
        <span><a>@title</a></span>
      }</p>
    }
  }
}

@title(item: services.item.Item) = {
  @defining(item.isConflationOf.flatMap(_.homepage)) { urls =>
    @if(!urls.isEmpty) {
      <h3 class="item-title"><a href="@urls.head">@item.title</a></h3>
      <p class="item-homepage"><a href="@urls.head" target="_blank">@urls.head</a></p>
    }
  }
}

@description(item: services.item.Item) = {
  @defining(item.isConflationOf.flatMap(_.descriptions)) { descriptions =>
    @if(!descriptions.isEmpty) {
      <p class="item-description">@descriptions.head.description</p>
    }
  }
}
